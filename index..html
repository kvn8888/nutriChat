<!DOCTYPE html>
<html>
<head>
  <title>My App</title>
  <script>
    function handleButtonPress() {
      var apiKey = document.getElementById('apiKey').value;
      var message = document.getElementById('message').value;

      var options = {
        method: 'POST',
        headers: {
          accept: 'application/json',
          'content-type': 'application/json',
          authorization: 'Bearer ' + apiKey
        },
        body: JSON.stringify({
          model: 'mixtral-8x7b-instruct',
          messages: [
            {
              role: 'system',
              content: 'Only respond in JSON. The JSON will have attributes of Calories, Carbs, Fats, Protein ONLY. All four of these attributes. NEVER OUTPUT ANYTHING OUTSIDE THE THREE ATTRIBUTES INSIDE THE JSON. **Important**: Once you have finished outputting JSON, end the response immediately, NEVER PUT UNITS!!!!!!!!!!!!!'
            },
            {role: 'user', content: message}
          ]
        })
      };

      fetch('/api/chat/completions', options)
        .then(response => {
          console.log(response); // Log the raw response
          if (!response.ok) {
            throw new Error('Network response was not ok');
          }
          return response.json();
        })
        .then(data => {
          console.log(data);
          document.getElementById('response').textContent = JSON.stringify(data);
        })
        .catch(err => console.error(err));
        document.getElementById('apiKey').style.display = 'none';
        document.getElementById('submitButton').style.display = 'none';
    }
  </script>
</head>
<body>
  <div class='App'>
    <h1>NutriChat</h1>
    <h3>Type in a query, and see some macro nutrients!</h3>
    <p id='response'></p>
    <input id='apiKey' type='text' placeholder='Enter API Key' />
    <input id='message' type='text' placeholder='Enter Message' />
    <button onclick='handleButtonPress()'>Send</button>
  </div>
</body>
</html>